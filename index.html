<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>TheSale3 Camping Store | Premium Outdoor Gear Laos</title>
    <meta name="description" content="Premium outdoor equipment for the Lao adventurer. Shop portable stoves, tents, coffee gear, and furniture. Quality tested for Laos terrain. Contact +8562054849393.">
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="TheSale3 Camping Store | Cloud Powered">
    <meta property="og:description" content="Premium outdoor equipment for the Lao adventurer. Click to browse our catalog.">
    <meta property="og:image" content="https://i.postimg.cc/FKL5Q4JW/489751506-1424454392283349-8154752889413656228-n.jpg">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #fcfcfc; color: #111827; }
        .hero-banner { background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.4)), url('https://i.postimg.cc/FKL5Q4JW/489751506-1424454392283349-8154752889413656228-n.jpg'); background-size: cover; background-position: center; }
        .nav-blur { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
        .product-card { background: #ffffff; border: 1px solid #f3f4f6; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); border-radius: 24px; }
        .product-card:hover { transform: translateY(-6px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .category-pill { transition: all 0.3s ease; white-space: nowrap; }
        .category-pill.active { background-color: #059669; color: white; border-color: #059669; }
        .modal-overlay { background: rgba(0,0,0,0.8); backdrop-filter: blur(8px); }
        .whatsapp-btn { background: #25D366; transition: all 0.3s ease; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.5s ease forwards; }

        /* Cart Animations */
        .cart-badge {
            animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes pop {
            0% { transform: scale(0.5); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="nav-blur sticky top-0 z-50 border-b border-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6">
            <div class="flex justify-between items-center h-16 sm:h-20">
                <div class="flex flex-col">
                    <span class="font-black text-xl leading-none tracking-tight text-black uppercase">THESALE3</span>
                    <span class="text-[9px] font-bold text-emerald-600 tracking-[0.2em] uppercase">Camping Store</span>
                </div>
                <div class="flex items-center gap-6">
                    <!-- Cart Trigger -->
                    <button onclick="openCart()" class="relative group p-2">
                        <i class="fa-solid fa-cart-shopping text-2xl text-gray-800 group-hover:text-emerald-600 transition"></i>
                        <span id="cartCount" class="cart-badge absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-black w-5 h-5 flex items-center justify-center rounded-full border-2 border-white hidden">0</span>
                    </button>
                    <a href="https://wa.me/8562054849393" target="_blank" class="flex items-center gap-2 group">
                        <i class="fa-brands fa-whatsapp text-2xl text-emerald-500 group-hover:scale-110 transition"></i>
                        <span class="hidden sm:block text-[11px] font-bold uppercase tracking-widest text-gray-900">Contact</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <header class="hero-banner h-[300px] sm:h-[400px] flex items-center justify-center text-center px-4">
        <div class="max-w-3xl">
            <h1 class="text-4xl sm:text-6xl font-black text-white mb-4 tracking-tighter drop-shadow-2xl">TheSale3 Store</h1>
            <p class="text-gray-200 text-sm sm:text-lg mb-8 font-medium drop-shadow-md max-w-lg mx-auto uppercase tracking-widest">Premium Camping Gear Laos</p>
            <a href="#catalog" class="bg-emerald-600 text-white px-8 py-3.5 rounded-full font-bold text-[10px] uppercase tracking-[0.2em] hover:bg-emerald-700 transition shadow-2xl inline-block">Browse Collection</a>
        </div>
    </header>

    <!-- Catalog -->
    <main id="catalog" class="max-w-7xl mx-auto px-4 sm:px-6 py-10 flex-grow w-full">
        <div class="flex flex-col lg:flex-row justify-between items-center mb-10 gap-6">
            <div id="categoryContainer" class="flex gap-2 overflow-x-auto no-scrollbar w-full lg:w-auto pb-4">
                <button onclick="filterBy('all', this)" class="category-pill active bg-emerald-600 text-white px-6 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest border border-transparent">All / ທັງໝົດ</button>
                <button onclick="filterBy('tents', this)" class="category-pill bg-white border border-gray-100 text-gray-400 px-6 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:border-emerald-600">Tents / ເຕັ້ນ</button>
                <button onclick="filterBy('cooking', this)" class="category-pill bg-white border border-gray-100 text-gray-400 px-6 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:border-emerald-600">Cooking / ເຄື່ອງຄົວ</button>
                <button onclick="filterBy('coffee', this)" class="category-pill bg-white border border-gray-100 text-gray-400 px-6 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:border-emerald-600">Coffee / ກາເຟ</button>
                <button onclick="filterBy('lighting', this)" class="category-pill bg-white border border-gray-100 text-gray-400 px-6 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:border-emerald-600">Lighting / ໄຟ</button>
                <button onclick="filterBy('sleeping_gear', this)" class="category-pill bg-white border border-gray-100 text-gray-400 px-6 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:border-emerald-600">Sleeping / ເຄື່ອງນອນ</button>
                <button onclick="filterBy('furniture', this)" class="category-pill bg-white border border-gray-100 text-gray-400 px-6 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:border-emerald-600">Furniture / ເຟີນີເຈີ</button>
                <button onclick="filterBy('backpack', this)" class="category-pill bg-white border border-gray-100 text-gray-400 px-6 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:border-emerald-600">Backpack / ກະເປົ໋າ</button>
                <button onclick="filterBy('trekking_poles', this)" class="category-pill bg-white border border-gray-100 text-gray-400 px-6 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:border-emerald-600">Poles / ໄມ້ເທົ້າ</button>
            </div>
            
            <div class="relative w-full lg:w-72">
                <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 text-sm"></i>
                <input type="text" id="searchInput" oninput="searchItems()" placeholder="Search / ຄົ້ນຫາ..." class="w-full pl-12 pr-4 py-3 rounded-2xl border-none ring-1 ring-gray-200 focus:ring-2 focus:ring-emerald-500 shadow-sm transition">
            </div>
        </div>

        <div id="productGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
    </main>

    <!-- Product Details Modal -->
    <div id="modal" style="display: none;" class="fixed inset-0 z-[100] modal-overlay items-center justify-center p-4" onclick="if(event.target === this) closeModals()">
        <div class="bg-white rounded-[32px] max-w-4xl w-full overflow-hidden shadow-2xl relative flex flex-col md:flex-row max-h-[90vh]">
            <button onclick="closeModals()" class="absolute top-4 right-4 text-gray-400 hover:text-black z-20 bg-white/80 w-10 h-10 rounded-full flex items-center justify-center shadow-sm"><i class="fa-solid fa-xmark"></i></button>
            <div class="md:w-1/2 bg-gray-50 h-64 md:h-auto overflow-hidden">
                <img id="modalImage" src="" alt="" class="w-full h-full object-cover">
            </div>
            <div class="p-8 md:p-12 md:w-1/2 flex flex-col overflow-y-auto">
                <span id="modalCategory" class="text-emerald-700 text-[10px] font-bold uppercase tracking-[0.3em] mb-4"></span>
                <h2 id="modalTitle" class="text-3xl font-black text-gray-900 mb-4 tracking-tighter"></h2>
                <p id="modalPrice" class="text-2xl font-bold text-emerald-600 mb-6 italic"></p>
                <div class="h-1 w-12 bg-emerald-600 mb-6"></div>
                <p id="modalDescription" class="text-gray-500 text-sm leading-relaxed mb-8 flex-grow whitespace-pre-line"></p>
                
                <div class="flex gap-4">
                    <button id="addToCartBtn" class="bg-black text-white px-8 py-4 rounded-2xl font-black flex-grow flex items-center justify-center gap-3 shadow-lg uppercase tracking-widest text-xs hover:bg-gray-800 transition">
                        <i class="fa-solid fa-cart-plus text-xl"></i> Add to Cart
                    </button>
                    <a id="whatsappBtn" href="#" target="_blank" class="whatsapp-btn text-white p-4 rounded-2xl font-black flex items-center justify-center shadow-lg transition">
                        <i class="fa-brands fa-whatsapp text-2xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" style="display: none;" class="fixed inset-0 z-[110] modal-overlay items-center justify-end" onclick="if(event.target === this) closeCart()">
        <div class="bg-white h-full max-w-lg w-full shadow-2xl flex flex-col fade-in">
            <div class="p-8 border-b flex justify-between items-center">
                <h2 class="text-2xl font-black uppercase tracking-tight text-emerald-800">Shopping Cart / ກະຕ່າ</h2>
                <button onclick="closeCart()" class="text-gray-400 hover:text-black"><i class="fa-solid fa-xmark text-2xl"></i></button>
            </div>
            
            <div id="cartItems" class="flex-grow overflow-y-auto p-8 space-y-6">
                <div class="text-center py-20 text-gray-400">Your cart is empty / ບໍ່ມີສິນຄ້າໃນກະຕ່າ</div>
            </div>

            <div class="p-8 border-t bg-gray-50">
                <div class="flex justify-between items-center mb-6">
                    <span class="font-bold text-gray-500 uppercase tracking-widest text-xs">Total Amount / ລວມທັງໝົດ</span>
                    <span id="cartTotal" class="text-2xl font-black text-emerald-600 italic">0 LAK</span>
                </div>
                <button onclick="sendOrderWhatsApp()" class="whatsapp-btn w-full text-white py-5 rounded-2xl font-black flex items-center justify-center gap-4 shadow-xl uppercase tracking-widest text-sm hover:brightness-110 transition">
                    <i class="fa-brands fa-whatsapp text-2xl"></i> Order via WhatsApp / ສັ່ງຊື້ຜ່ານວອດແອບ
                </button>
            </div>
        </div>
    </div>

    <footer class="bg-white border-t py-12 px-4 text-center mt-auto">
        <div class="flex justify-center items-center gap-4 mb-6 relative">
            <a href="https://www.facebook.com/Clicktobuy333333333" target="_blank" class="text-gray-300 hover:text-blue-600 transition"><i class="fa-brands fa-facebook-f text-xl"></i></a>
            <a href="https://www.tiktok.com/@thesale3camping" target="_blank" class="text-gray-300 hover:text-black transition"><i class="fa-brands fa-tiktok text-xl"></i></a>
        </div>
        <div class="mb-4"><span class="font-bold uppercase tracking-[0.3em] text-[10px] text-gray-900">TheSale3 Camping Store</span></div>
        <p class="text-[9px] text-gray-300 uppercase tracking-[0.2em] select-none">&copy; 2024 All Rights Reserved. Premium Gear Shop.</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Mapping for Bilingual Categories
        const catMap = {
            'all': 'All Gear / ສິນຄ້າທັງໝົດ',
            'tents': 'Tents / ເຕັ້ນ',
            'cooking': 'Cooking / ເຄື່ອງຄົວ',
            'coffee': 'Coffee / ກາເຟ',
            'lighting': 'Lighting / ໄຟສ່ອງສະຫວ່າງ',
            'sleeping_gear': 'Sleeping / ເຄື່ອງນອນ',
            'furniture': 'Furniture / ເຟີນີເຈີ',
            'backpack': 'Backpack / ກະເປົ໋າ',
            'trekking_poles': 'Poles / ໄມ້ເທົ້າ'
        };

        const SYSTEM_PRODUCTS = [
            // --- TENTS ---
            { id: 'master-01', name: 'ເຕັ້ນ QUECHUA MH100 Fresh & Black (2 ຄົນ)', price: 1460000, category: 'tents', image: 'https://i.postimg.cc/qv0hwyZz/471874894-1103166361597493-1459129778683580847-n.jpg', description: 'ເຕັ້ນ QUECHUA MH100 Fresh & Black (ບໍ່ແມ່ນເຕັ້ນກາງໂອໂຕ້) ສຳລັບ 2 ຄົນ.\n- Fresh & Black technology ensures darkness inside.\n- Tested for 200L/sqm/hr waterproof rating.' },
            // Fixed master-02 with multiple images support
            { 
              id: 'master-02', 
              name: 'ເຕັ້ນ QUECHUA MH100 (ສີເທົາ)', 
              price: 1100000, 
              category: 'tents', 
              image: 'https://i.postimg.cc/YCzbNjFr/156657757-198686858712119-7425055041363166372-n.jpg',
              images: [
                'https://i.postimg.cc/YCzbNjFr/156657757-198686858712119-7425055041363166372-n.jpg',
                'https://i.postimg.cc/nM8f7LYc/Screenshot-2026-01-14-at-18-55-51.png'
              ],
              description: 'Standard QUECHUA MH100 dome tent. Easy to pitch and freestanding structure.' 
            },

            // Fixed master-03 with multiple images support
            { id: 'master-03', 
              name: 'ເຕັ້ນກາງອັດຕະໂນມັດ Premium (3-4 ທ່ານ)', 
              price: 885000, 
              category: 'tents', 
              image: 'https://i.postimg.cc/6pCRNRQF/124951381-118420500072089-6079077613874319164-n.jpg', 
              images: [
                'https://i.postimg.cc/6pCRNRQF/124951381-118420500072089-6079077613874319164-n.jpg',
                'https://i.postimg.cc/GpR7DyWZ/Screenshot-2026-01-14-at-19-17-53.png'
              ],
              description: 'Automatic pop-up mechanism for 3-4 persons. Water and mist resistant.' },
            { id: 'master-04', name: 'ເຕັ້ນກາງອັດຕະໂນມັດ (Pop-up)', price: 890000, category: 'tents', image: 'https://i.postimg.cc/7LQ62Yt4/481250252-1394483935280395-2343742065073889579-n.jpg', description: 'ເຕັ້ນກາງອັດຕະໂນມັດກັນຫມອກໄດ້ ແຕ່ບໍ່ກັນຝົນคุณสมบัติเต็นท์กางอัตโนมัติ กางง่าย เก็บง่าย คนเดียวก็กางได้มีชั้นมุ้งตาข่าย สำหรับป้องกันยุง หรือ แมลงต่างๆ เข้ามาในเต็นท์เป็นแบบ 2 ประตู 2 หน้าต่าง มีมุ้งตาข่าย สำหรับกันแมลงด้วยAutomatic Pop-up Tent. Quick auto setup. Mist resistant.' },
            { id: 'master-05', name: 'ເຕັ້ນສະປິງກາງອັດຕະໂນມັດ', price: 650000, category: 'tents', image: 'https://i.postimg.cc/NGWkqQ4R/127859284-131667258747413-3464652703126584755-n.jpg', description: 'Standard Automatic Spring Tent. Simple and fast setup.' },
            { id: 'master-06', name: 'ຜ້າກັ້ງກັນຝົນ Flysheet (3x3 ແມັດ)', price: 340000, category: 'tents', image: 'https://i.postimg.cc/fW6VCK77/509364307-1482014006527387-4608802055488310889-n.jpg', description: 'Changleyou Flysheet 3x3m with 2 poles. Waterproof: 2000-3000mm.' },
            { id: 'master-07', name: 'ຜ້າຢາງຮອງເຕັ້ນ (Groundsheet)', price: 200000, category: 'tents', image: 'https://i.postimg.cc/fTzmhkdX/471871594-1103166028264193-3080110264274826660-n.jpg', description: 'GS SPORT Groundsheet 2.1m x 2m. Rain and sun protection.' },
            { id: 'master-08', name: 'ສະໝໍບົກ (Tent Pegs 20cm)', price: 50000, category: 'tents', image: 'https://i.postimg.cc/B6PqPrzQ/472186338-1103166364930826-8197764758286830200-n.jpg', description: 'Heavy duty 20cm tent pegs.\n- 50,000 LAK per unit.\n- 140,000 LAK for 4 units.' },

            // --- COOKING ---
            { id: 'master-09', name: 'ເຕົາແກັດພົກພາ AOTU', price: 285000, category: 'cooking', image: 'https://i.postimg.cc/HLsDXqV6/470820202-1095258122388317-6701559630283280350-n.jpg', description: 'AOTU high-power portable gas stove. Average boiling time: 3-5 min.' },
            { id: 'master-10', name: 'ການ້ຳ (Outdoor Kettle 800ml)', price: 240000, category: 'cooking', image: 'https://i.postimg.cc/SxcCCPwR/124985548-118420480072091-5504697490990489685-n.jpg', description: '800ml aluminum alloy kettle. Scratch and corrosion resistant.' },
            { id: 'master-11', name: 'ເຫຼັກຢຶດຂາຕັ້ງສາມຂາ (Tripod Bracket)', price: 160000, category: 'cooking', image: 'https://i.postimg.cc/XqZyJ1fj/470195754-1095096232404506-5723296061682898594-n.jpg', description: 'Shandike Stainless steel tripod bracket for campfire cooking.' },
            { id: 'master-12', name: 'ຊຸດໝໍ້ສຳລັບ 3 ຫາ 4 ຄົນ (DS-308)', price: 430000, category: 'cooking', image: 'https://i.postimg.cc/bw8m2q4T/150739603-186271443286994-1875422230249930637-n.jpg', description: 'DS-308 Outdoor Cooking Set. Includes pan, pot, and kettle.' },
            { id: 'master-13', name: 'ເຕົາແກັດນ້ອຍມີສາຍ (Hose Stove)', price: 200000, category: 'cooking', image: 'https://i.postimg.cc/kgvtYbwk/476775570-1132392825341513-296684994834635171-n.jpg', description: 'Portable mini gas stove with hose for stability.' },
            { id: 'master-14', name: 'ເຕົາແກັດນ້ອຍມີອັນບັງລົມ (Windproof Stove)', price: 180000, category: 'cooking', image: 'https://i.postimg.cc/mrd1BWvN/470235034-1091427629438033-3849741322793284301-n-(2).jpg', description: 'Portable Stove with foldable windshield. Weighs only 400g.' },
            { id: 'master-15', name: 'ເຕົາແກັດຂະຫນﺎດນ້ອຍ (Picnic Stove K-202)', price: 165000, category: 'cooking', image: 'https://i.postimg.cc/3RfYqSQJ/150468425-186271443286994-1875422230249930637-n.jpg', description: 'Small Picnic Stove K-202 with piezo ignition.' },
            { id: 'master-16', name: 'ໝໍ້ຂຽວທະຫານ (Army Military Pot)', price: 300000, category: 'cooking', image: 'https://i.postimg.cc/63x4bQwN/470161529-1091427636104699-6870152323458159947-n-(1).jpg', description: 'Army Green Military Pot. 1.8L Aluminum construction.' },

            // --- COFFEE ---
            { id: 'master-17', name: 'ຈອກແແຄ້ມປີ້ງ Cool Camp (4 ໃບ)', price: 260000, category: 'coffee', image: 'https://i.postimg.cc/L5yDLPPw/202323323-277134600867344-8457321312918561749-n.jpg', description: 'Set of 4 stainless steel cups (350ml) with bag.' },
            { id: 'master-18', name: 'ໝໍ້ຕົ້ມກາເຟ Espresso Maker (300ml)', price: 200000, category: 'coffee', image: 'https://i.postimg.cc/zDbXHNr1/472106912-1101699191744210-325644103738198928-n-(1).jpg', description: 'Moka Pot Espresso Maker 300ml Aluminum.' },
            { id: 'master-19', name: 'ເຄື່ອງບົດກາເຟ (Coffee Grinder)', price: 195000, category: 'coffee', image: 'https://i.postimg.cc/vZNN0NDm/138558955_160501135864025_1071256138491929297_n.jpg', description: 'Manual vintage coffee bean grinder with ceramic burr.' },

            // --- LIGHTING ---
            { id: 'master-20', name: 'ຕະກຽງ LED (HOMFUL Lantern)', price: 320000, category: 'lighting', image: 'https://i.postimg.cc/YS7Vz1V8/470138708-1091427639438032-4054288834215141234-n.jpg', description: 'Rechargeable LED Lantern by HOMFUL. 1200 mAh.' },
            { id: 'master-21', name: 'ເສົາຫ້ອຍໂຄມໄຟ (Lantern Stand)', price: 250000, category: 'lighting', image: 'https://i.postimg.cc/Mp0CfPHz/470580274-1094729429107853-518082534720816909-n.jpg', description: 'LK＆VS Metal Lantern Stand. Adjustable height.' },
            { id: 'master-22', name: 'ເຫຼັກຫ້ອຍດອກໄຟ (Lantern Hook)', price: 70000, category: 'lighting', image: 'https://i.postimg.cc/FKyCB7cG/471590824-1101698975077565-9125211727583692069-n.jpg', description: 'Metal lantern hook for gear or lights.' },

            // --- SLEEPING ---
            { id: 'master-23', name: 'ເຊື່ອນອນເປົ່າລົມ Naturehike Air', price: 600000, category: 'sleeping_gear', image: 'https://i.postimg.cc/C5cQ41XF/476403930-1129881948925934-1365118939146447544-n.jpg', description: 'Naturehike Air moisture-proof ultralight mat.' },
            { id: 'master-24', name: 'ເຊື່ອນອນເປົ່າລົມອັດຕະໂນມັດ', price: 330000, category: 'sleeping_gear', image: 'https://i.postimg.cc/8cXZ6Yft/138639462-160500882530717-1634793276813040683-n.jpg', description: 'Self-inflatable mattress with pillow. 186x57x2.5cm.' },
            { id: 'master-25', name: 'ຖົງນອນ MUZENT (5°C)', price: 420000, category: 'sleeping_gear', image: 'https://i.postimg.cc/SQH8nqJr/470732130-1095258142388315-6675372278210325168-n.jpg', description: 'MUZENT Sleeping bag for cold weather (5°C).' },
            { id: 'master-26', name: 'ຖົງນອນ Naturehike Premium', price: 550000, category: 'sleeping_gear', image: 'https://i.postimg.cc/28xJzH5Y/483101086-1400042418057880-8967539400801900911-n-(1).jpg', description: 'Premium Naturehike sleeping bag.' },
            { id: 'master-27', name: 'ຖົງນອນ ແບບພົກພາ (Portable Bag)', price: 215000, category: 'sleeping_gear', image: 'https://i.postimg.cc/T2bjqp8S/125315138-118420533405419-8079952364573550993-n.jpg', description: 'Portable outdoor sleeping bag (700g). 4 colors.' },
            { id: 'master-28', name: 'ໝອນນອນເປົ່າລົມ (Inflatable Pillow)', price: 40000, category: 'sleeping_gear', image: 'https://i.postimg.cc/kgj91M3M/138786732-160501152530690-3533211310814187676-n.jpg', description: 'Portable pillow: 40,000 LAK per unit or 65,000 LAK for 2.' },

            // --- FURNITURE & OTHERS ---
            { id: 'master-29', name: 'ໂຕະແຄ້ມປິ້ງ (Camping Table M)', price: 390000, category: 'furniture', image: 'https://i.postimg.cc/MG8JHcSH/470180269-1091456466101816-3503156836293091321-n.jpg', description: 'Foldable Aluminum Table M (56x41x41cm). Includes bag.' },
            { id: 'master-30', name: 'ຕັ່ງແແຄ້ມປີ້ງ ShineTrip', price: 285000, category: 'furniture', image: 'https://i.postimg.cc/0jSsW7Gc/470209749-1091969312717198-8585518212376997562-n.jpg', description: 'ShineTrip Aluminum folding chair. Portable and comfortable.' },
            { id: 'master-31', name: 'ກະເປົ໋າເປ້ 65L Camel', price: 1350000, category: 'backpack', image: 'https://i.postimg.cc/8P7KVyMZ/471164242-1095570065690456-156288641806394470-n-(1).jpg', description: 'Professional Camel 65L Hiking Backpack. Size: 36x25x62cm.' },
            { id: 'master-32', name: 'ຜ້າກັນຝົນສຳລັບກະເປົ໋າ (Rain Cover)', price: 70000, category: 'backpack', image: 'https://i.postimg.cc/ZKkc16FY/139180898-160501215864017-905798667929076806-n.jpg', description: 'Waterproof covers: 70,000 LAK (35L) / 80,000 LAK (70L).' },
            { id: 'master-33', name: 'ໄມ້ເທົ້າຢ່າງປ່າ Naturehike', price: 335000, category: 'trekking_poles', image: 'https://i.postimg.cc/8PgDFr4N/488790917-1423518039043651-721068063865014396-n-(1).jpg', description: 'Strong and light Naturehike Hiking Pole.' },
            { id: 'master-34', name: 'ໄມ້ກັນເທົ້າຢ່າງປ່າ (Standard Pole)', price: 140000, category: 'trekking_poles', image: 'https://i.postimg.cc/L65784Kh/189756927-258928419354629-5324966725450305500-n-(1).jpg', description: 'Standard Trekking Pole. Adjustable and foldable. Ergonomic grip.' },
            { id: 'master-35', name: 'ກະເປົ໋ານ້ອຍຫ້ອຍແອວ (Waist Bag)', price: 100000, category: 'backpack', image: 'https://i.postimg.cc/7PpfY6j0/476359221-1130686925512103-8223380318275171227-n.jpg', description: 'Tactical Waist Bag. Durable gadget belt bag.' }
        ];

        let products = [...SYSTEM_PRODUCTS];
        let cart = [];
        let currentCat = 'all';

        // Cart Functions
        window.openCart = () => {
            renderCart();
            document.getElementById('cartModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        };

        window.closeCart = () => {
            document.getElementById('cartModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        };

        window.addToCart = (productId) => {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const existing = cart.find(item => item.id === productId);
            if (existing) {
                existing.quantity += 1;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            updateCartUI();
        };

        window.updateCartQuantity = (productId, delta) => {
            const item = cart.find(i => i.id === productId);
            if (!item) return;
            item.quantity += delta;
            if (item.quantity <= 0) {
                cart = cart.filter(i => i.id !== productId);
            }
            updateCartUI();
            renderCart();
        };

        function updateCartUI() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            const badge = document.getElementById('cartCount');
            if (count > 0) {
                badge.innerText = count;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
            localStorage.setItem('thesale3_cart', JSON.stringify(cart));
        }

        function renderCart() {
            const container = document.getElementById('cartItems');
            const totalEl = document.getElementById('cartTotal');
            
            if (cart.length === 0) {
                container.innerHTML = `<div class="text-center py-20 text-gray-400">
                    <i class="fa-solid fa-cart-arrow-down text-5xl mb-4 opacity-20"></i>
                    <p class="font-bold uppercase tracking-widest text-xs">Your cart is empty / ບໍ່ມີສິນຄ້າໃນກະຕ່າ</p>
                </div>`;
                totalEl.innerText = '0 LAK';
                return;
            }

            let total = 0;
            container.innerHTML = cart.map(item => {
                total += item.price * item.quantity;
                return `
                <div class="flex items-center gap-4 bg-white p-4 rounded-2xl border border-gray-100 shadow-sm fade-in">
                    <img src="${item.image}" class="w-20 h-20 object-cover rounded-xl shadow-sm">
                    <div class="flex-grow">
                        <h4 class="font-bold text-sm text-gray-900 leading-tight mb-1">${item.name}</h4>
                        <p class="text-emerald-600 font-bold text-xs">${Number(item.price).toLocaleString()} LAK</p>
                    </div>
                    <div class="flex flex-col items-end gap-2">
                        <div class="flex items-center bg-gray-50 rounded-lg border border-gray-100 p-1">
                            <button onclick="updateCartQuantity('${item.id}', -1)" class="w-6 h-6 flex items-center justify-center text-gray-400 hover:text-black transition"><i class="fa-solid fa-minus text-[10px]"></i></button>
                            <span class="w-8 text-center text-xs font-black">${item.quantity}</span>
                            <button onclick="updateCartQuantity('${item.id}', 1)" class="w-6 h-6 flex items-center justify-center text-gray-400 hover:text-black transition"><i class="fa-solid fa-plus text-[10px]"></i></button>
                        </div>
                        <span class="text-[10px] font-black text-gray-400">${(item.price * item.quantity).toLocaleString()} LAK</span>
                    </div>
                </div>`;
            }).join('');
            totalEl.innerText = `${total.toLocaleString()} LAK`;
        }

        window.sendOrderWhatsApp = () => {
            if (cart.length === 0) return;
            
            let message = "Sabaidee! ຂ້ອຍຕ້ອງການສັ່ງຊື້ສິນຄ້າລຸ່ມນີ້ / I would like to order:\n\n";
            let total = 0;
            
            cart.forEach((item, index) => {
                const subtotal = item.price * item.quantity;
                total += subtotal;
                message += `${index + 1}. ${item.name}\n`;
                message += `   ຈຳນວນ / Qty: ${item.quantity}\n`;
                message += `   ລາຄາ / Price: ${item.price.toLocaleString()} LAK\n`;
                message += `   ລວມ / Subtotal: ${subtotal.toLocaleString()} LAK\n`;
                message += `   ຮູບ / Image: ${item.image}\n\n`;
            });

            message += `--------------------------\n`;
            message += `GRAND TOTAL / ລວມທັງໝົດ: ${total.toLocaleString()} LAK\n`;
            message += `--------------------------\n`;
            message += `Please confirm my order. Thank you!`;

            const encoded = encodeURIComponent(message);
            window.open(`https://wa.me/8562054849393?text=${encoded}`, '_blank');
        };

        // Navigation & Filter Functions
        window.filterBy = (cat, btn) => {
            currentCat = cat;
            document.querySelectorAll('.category-pill').forEach(b => b.className = 'category-pill bg-white border border-gray-100 text-gray-400 px-6 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:border-emerald-600');
            btn.className = 'category-pill active bg-emerald-600 text-white px-6 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest border border-transparent';
            applyFilters();
        };

        window.searchItems = () => applyFilters();

        function applyFilters() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const filtered = products.filter(p => (currentCat === 'all' || p.category === currentCat) && p.name.toLowerCase().includes(search));
            render(filtered);
        }

        function render(items) {
            const grid = document.getElementById('productGrid');
            if(!grid) return;
            if(items.length === 0) { grid.innerHTML = '<div class="col-span-full py-20 text-center text-gray-400 italic">No gear matches that filter.</div>'; return; }
            grid.innerHTML = items.map(p => `
                <div class="product-card group overflow-hidden flex flex-col cursor-pointer fade-in" onclick="openDetails('${p.id}')">
                    <div class="h-64 bg-gray-50 overflow-hidden relative"><img src="${p.image}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"></div>
                    <div class="p-8 flex flex-col flex-grow text-left">
                        <span class="text-[9px] font-bold text-gray-400 uppercase tracking-widest mb-2">${catMap[p.category] || p.category}</span>
                        <h3 class="font-bold text-lg mb-1 text-gray-900 tracking-tight">${p.name}</h3>
                        <p class="text-base font-bold text-emerald-600 mb-6 italic">LAK ${Number(p.price).toLocaleString()}</p>
                        <div class="mt-auto flex items-center justify-between">
                            <span class="flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-gray-900">Check Gear / ເບິ່ງເພີ່ມ <i class="fa-solid fa-arrow-right-long text-emerald-600 group-hover:translate-x-1 transition"></i></span>
                            <button onclick="event.stopPropagation(); addToCart('${p.id}')" class="bg-gray-100 p-2 rounded-lg text-gray-800 hover:bg-emerald-600 hover:text-white transition"><i class="fa-solid fa-plus"></i></button>
                        </div>
                    </div>
                </div>`).join('');
        }

        window.openDetails = (id) => {
            const p = products.find(x => x.id === id);
            if (!p) return;
            document.getElementById('modalTitle').innerText = p.name;
            document.getElementById('modalCategory').innerText = catMap[p.category] || p.category;
            document.getElementById('modalPrice').innerText = `LAK ${Number(p.price).toLocaleString()}`;
            document.getElementById('modalDescription').innerText = p.description;
            document.getElementById('modalImage').src = p.image;
            
            // Single item WhatsApp button
            document.getElementById('whatsappBtn').href = `https://wa.me/8562054849393?text=${encodeURIComponent("Sabaidee! ຂ້ອຍສົນໃຈ: " + p.name + " (" + Number(p.price).toLocaleString() + " LAK)\nຮູບ: " + p.image)}`;
            
            const addBtn = document.getElementById('addToCartBtn');
            addBtn.onclick = () => {
                addToCart(p.id);
                addBtn.innerHTML = '<i class="fa-solid fa-check text-xl"></i> Added / ເພີ່ມແລ້ວ';
                setTimeout(() => {
                    addBtn.innerHTML = '<i class="fa-solid fa-cart-plus text-xl"></i> Add to Cart / ໃສ່ກະຕ່າ';
                }, 1500);
            };

            document.getElementById('modal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        };

        window.closeModals = () => { document.getElementById('modal').style.display = 'none'; document.body.style.overflow = 'auto'; };

        document.addEventListener('DOMContentLoaded', () => {
            const savedCart = localStorage.getItem('thesale3_cart');
            if (savedCart) { cart = JSON.parse(savedCart); updateCartUI(); }

            applyFilters();
            try {
                const configStr = typeof __firebase_config !== 'undefined' ? __firebase_config : null;
                if (!configStr) return;
                const firebaseConfig = JSON.parse(configStr);
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'thesale3-camping';
                const app = initializeApp(firebaseConfig);
                const auth = getAuth(app);
                const db = getFirestore(app);
                const initAuth = async () => {
                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) await signInWithCustomToken(auth, __initial_auth_token);
                    else await signInAnonymously(auth);
                };
                initAuth();
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        const productCol = collection(db, 'artifacts', appId, 'public', 'data', 'products');
                        onSnapshot(productCol, (snap) => {
                            const dbProducts = snap.docs.map(d => ({ id: d.id, ...d.data() }));
                            const systemIds = SYSTEM_PRODUCTS.map(p => p.id);
                            products = [...SYSTEM_PRODUCTS, ...dbProducts.filter(p => !systemIds.includes(p.id))];
                            applyFilters();
                        });
                    }
                });
            } catch (err) { console.warn("Firebase not loaded:", err); }
        });
    </script>
</body>
</html>
